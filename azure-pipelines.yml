trigger:
- main  # Change to your branch

pool:
  vmImage: 'ubuntu-latest'

variables:
- group: PAT_TOKENS  # ‚úÖ Ensure secrets are pulled from Azure DevOps Library

steps:
- script: |
    echo "üîç Checking environment variables..."
    echo "üîç AZURE_DEVOPS_PAT length: ${#AZURE_DEVOPS_PAT}"  # Should print a number
    echo "üîç GITHUB_PAT length: ${#GITHUB_PAT}"

    # ‚úÖ Explicitly export the variables
    export AZURE_DEVOPS_PAT="${AZURE_DEVOPS_PAT}"
    export GITHUB_PAT="${GITHUB_PAT}"

    # ‚úÖ Print inside Python before running the script
    # python -c "import os; print(f'AZURE_DEVOPS_PAT in Python: {os.getenv("AZURE_DEVOPS_PAT")}')"

    python -m pip install --upgrade pip
    python sync_to_github.py
  env:
    AZURE_DEVOPS_PAT: $(AZURE_DEVOPS_PAT)  # ‚úÖ Ensures secret is passed correctly
    GITHUB_PAT: $(GITHUB_PAT)
  displayName: "Run Python Sync Script"
